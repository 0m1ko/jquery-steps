/*! 
 * jQuery-steps v0.9.6 - 05/22/2013
 * Copyright (c) 2013 Rafael J. Staib (https://github.com/rstaib/jquery-steps)
 * Licensed under MIT http://www.opensource.org/licenses/MIT
 */
(function(e){function t(t){var n=e.extend(!0,{},e.fn.steps.defaults,t);return this.each(function(){var t=e(this);t.data("options",n),t.data("state",{currentIndex:n.startIndex,currentStep:null,stepCount:0,transitionShowElement:null}),m(t),s(t),n.autoFocus&&1===y&&e(".steps li.current a",t).focus(),t.bind("finishing.steps",n.onFinishing),t.bind("finished.steps",n.onFinished),t.bind("stepChanging.steps",n.onStepChanging),t.bind("stepChanged.steps",n.onStepChanged),n.enableKeyNavigation&&t.keyup(g),e(".steps a",t).bind("click.steps",I),e(".actions a",t).bind("click.steps",x)})}function n(t,n){var a=t.data("options"),s=t.data("state"),r=s.currentIndex;if(n>=0&&s.stepCount>n&&!(a.forceMoveForward&&s.currentIndex>n)){var i=e(".steps a[href$='-"+n+"']",t),o=i.parent(),d=o.hasClass("disabled");return o.removeClass("disabled"),i.click(),r===s.currentIndex&&d?(o.addClass("disabled"),!1):!0}return!1}function a(t,n){var a=t.data("options"),s=t.data("state");if(0>n||n>=s.stepCount||0===s.stepCount)throw Error("Index out of range.");if(!(a.forceMoveForward&&s.currentIndex>n)){var r=s.currentIndex;if(t.triggerHandler("stepChanging",[s.currentIndex,n])){s.currentIndex=n,b(t,n),s.currentStep=p(t,n),d(t,n,r),l(t),i(t);var o=e(".content > .body",t);switch(f(e.fn.steps.transitionEffect,a.transitionEffect)){case e.fn.steps.transitionEffect.fade:s.transitionShowElement=o.eq(n),o.eq(r).fadeOut(a.transitionEffectSpeed,function(){var t=e(this).parents(":has(.steps)"),n=t.data("state");n.transitionShowElement&&(n.transitionShowElement.fadeIn(a.transitionEffectSpeed),n.transitionShowElement=null)}).promise();break;case e.fn.steps.transitionEffect.slide:s.transitionShowElement=o.eq(n),o.eq(r).slideUp(a.transitionEffectSpeed,function(){var t=e(this).parents(":has(.steps)"),n=t.data("state");n.transitionShowElement&&(n.transitionShowElement.slideDown(a.transitionEffectSpeed),n.transitionShowElement=null)}).promise();break;case e.fn.steps.transitionEffect.slideLeft:var c=o.eq(n),u=o.eq(r),h=u.outerWidth(!0),m=n>r?-h:h,v=n>r?h:-h;u.animate({left:m},a.transitionEffectSpeed,function(){e(this).hide()}).promise(),c.css("left",v+"px").show(),c.animate({left:0},a.transitionEffectSpeed).promise();break;default:o.eq(r).hide(),o.eq(n).show()}t.triggerHandler("stepChanged",[n,r])}else e(".steps li:eq("+r+")",t).addClass("error");return!0}}function s(t){var n=t.data("options"),a=t.data("state"),s=e(document.createElement(n.contentContainerTag)).addClass("content"),o=n.startIndex;s.html(t.html()),t.addClass(n.cssClass).empty().append(s);var c=s.children(n.headerTag),u=s.children(n.bodyTag).addClass("body").hide();if(c.length>u.length)throw Error("One or more corresponding step contents are missing.");if(c.length<u.length)throw Error("One or more corresponding step titles are missing.");if(a.stepCount=u.length,n.saveState&&e.cookie){var f=e.cookie(E+v(t));null!=f&&Number(f)<a.stepCount&&(o=Number(f))}u.eq(o).show();var h=e(document.createElement(n.stepsContainerTag)).addClass("steps").append(e(document.createElement("ol")));if(t.prepend(h),c.each(function(a){r(t,e(this),a),o>a&&e(".steps > ol > li:eq("+a+")",t).addClass("done"),a>o&&!n.enableAllSteps&&e(".steps > ol > li:eq("+a+")",t).addClass("disabled")}),d(t,o),a.currentIndex=o,a.currentStep=p(t,a.currentIndex),n.enablePagination){var m=e(document.createElement("ul")),C=e(document.createElement(n.actionContainerTag)).addClass("actions").append(m);t.append(C),n.forceMoveForward||m.append(e('<li><a href="#previous">'+n.labels.previous+"</a></li>")),m.append(e('<li><a href="#next">'+n.labels.next+"</a></li>")),n.enableFinishButton&&m.append(e('<li><a href="#finish">'+n.labels.finish+"</a></li>")),l(t),i(t)}}function r(t,n,a){n.attr("id",v(t)+"-"+a).attr("tabindex","-1").addClass("title");var s=t.data("options"),r=t.data("state"),i=e(".steps > ol",t),o=c(s.titleTemplate,{index:a+1,title:n.html()}),d=e("<li></li>").html('<a href="#'+n.attr("id")+'">'+o+"</a>");0===a?i.prepend(d):e("li:eq("+(a-1)+")",i).after(d),0===a&&e("li",i).removeClass("first").eq(a).addClass("first"),a===r.stepCount-1&&e("li",i).removeClass("last").eq(a).addClass("last")}function i(t){var n=t.data("options"),a=t.data("state");if(!n.enableContentCache||!a.currentStep.contentLoaded)switch(f(e.fn.steps.contentMode,a.currentStep.contentMode)){case e.fn.steps.contentMode.iframe:e(".content > .body",t).eq(a.currentIndex).empty().html(e('<iframe src="'+a.currentStep.contentUrl+'" />')).data("loaded","1");break;case e.fn.steps.contentMode.async:var s=e(".content > .body",t).eq(a.currentIndex).empty().append(c(n.loadingTemplate,{text:n.labels.loading}));e.ajax({url:a.currentStep.contentUrl,cache:!1}).done(function(e){s.empty().html(e).data("loaded","1")})}}function o(t,n){for(var a=t.data("options"),s=n;t.data("state").stepCount>s;s++){var r=e(".content > .title:eq("+s+")",t).attr("id",v(t)+"-"+s);e(".steps > ol > li:eq("+s+") > a",t).attr("href","#"+v(t)+"-"+s).html(c(a.titleTemplate,{index:s+1,title:r.html()}))}}function d(t,n,a){var s=t.data("options"),r=e(".steps li",t),i=r.eq(n),o=e('<span class="current-info">'+s.labels.current+" </span>"),d=e(".content > .title",t);if(null!=a){var l=r.eq(a).addClass("done").removeClass("current error");d.eq(a).removeClass("current").next(".body").removeClass("current"),o=e("a > .current-info",l),i.children("a").focus()}i.addClass("current").removeClass("disabled done").children("a").prepend(o),d.eq(n).addClass("current").next(".body").addClass("current")}function l(t){var n=t.data("options"),a=t.data("state");if(n.enablePagination){var s=e(".actions a[href$='#finish']",t).parent(),r=e(".actions a[href$='#next']",t).parent();if(!n.forceMoveForward){var i=e(".actions a[href$='#previous']",t).parent();a.currentIndex>0?i.removeClass("disabled"):i.addClass("disabled")}n.enableFinishButton&&n.showFinishButtonAlways?0===a.stepCount?(s.addClass("disabled"),r.addClass("disabled")):a.stepCount>1&&a.stepCount>a.currentIndex+1?(s.removeClass("disabled"),r.removeClass("disabled")):(s.removeClass("disabled"),r.addClass("disabled")):0===a.stepCount?(s.hide(),r.show().addClass("disabled")):a.stepCount>a.currentIndex+1?(s.hide(),r.show().removeClass("disabled")):n.enableFinishButton?(s.show(),r.hide().addClass("disabled")):r.addClass("disabled")}}function c(e,t){for(var n=e.match(/#([a-z]*)#/gi),a=0;n.length>a;a++){var s=n[a],r=s.substring(1,s.length-1);e=e.replace(s,u(t,r))}return e}function u(e,t){if(void 0===e[t])throw Error('The key "'+t+'" does not exist in the substitute collection!');return e[t]}function p(t,n){var a=(t.data("options"),e(".content > .title:eq("+n+")",t)),s=a.next(".body"),r=null==s.data("mode")?e.fn.steps.contentMode.html:f(e.fn.steps.contentMode,/^\s*$/.test(s.data("mode"))||isNaN(s.data("mode"))?s.data("mode"):Number(s.data("mode"))),i=r===e.fn.steps.contentMode.html||void 0===s.data("url")?"":s.data("url"),o=r!==e.fn.steps.contentMode.html&&"1"===s.data("loaded");return{title:a.html(),content:r===e.fn.steps.contentMode.html?s.html():"",contentUrl:i,contentMode:r,contentLoaded:o}}function f(e,t){if(h("enumType",e),h("keyOrValue",t),"string"==typeof t){var n=e[t];if(void 0===n)throw Error('The enum key "'+t+'" does not exist.');return n}if("number"==typeof t){for(var a in e)if(e[a]===t)return t;throw Error('Invalid enum value "'+t+'".')}throw Error("Invalid key or value type.")}function h(e,t){if(null==t)throw Error('The argument "'+e+'" is null or undefined.')}function m(e){void 0===e.data("uid")&&e.data("uid","steps-uid-".concat(++y))}function v(e){return e.data("uid")}function C(e){return Number(e.attr("href").substring(e.attr("href").lastIndexOf("-")+1))}function b(t,n){var a=t.data("options");a.saveState&&e.cookie&&e.cookie(E+v(t),n)}function g(t){var n=e(this);if(n.data("options").suppressPaginationOnFocus&&e(":focus",n).is(":input"))return t.preventDefault(),!1;var a={left:37,right:39};t.keyCode===a.left?(t.preventDefault(),n.steps("previous")):t.keyCode===a.right&&(t.preventDefault(),n.steps("next"))}function x(t){t.preventDefault();var n=e(this),a=n.parents(":has(.steps)"),s=n.attr("href");switch(s.substring(s.lastIndexOf("#"))){case"#finish":a.steps("finish");break;case"#next":a.steps("next");break;case"#previous":a.steps("previous")}}function I(t){t.preventDefault();var n=e(this),s=n.parents(":has(.steps)"),r=s.data("state"),i=r.currentIndex;return n.parent().is(":not(.disabled):not(.current)")&&a(s,C(n)),i===r.currentIndex?(e(".steps a[href$=-"+i+"]",s).focus(),!1):void 0}var y=0,E="jQu3ry_5teps_St@te_";e.fn.steps=function(n){return e.fn.steps[n]?e.fn.steps[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?(e.error("Method "+n+" does not exist on jQuery.steps"),void 0):t.apply(this,arguments)},e.fn.steps.contentMode={html:0,iframe:1,async:2},e.fn.steps.transitionEffect={none:0,fade:1,slide:2,slideLeft:3},e.fn.steps.defaults={headerTag:"h1",bodyTag:"div",contentContainerTag:"div",actionContainerTag:"div",stepsContainerTag:"div",cssClass:"wizard",titleTemplate:'<span class="number">#index#.</span> #title#',loadingTemplate:'<span class="spinner"></span> #text#',autoFocus:!1,enableAllSteps:!1,enableKeyNavigation:!0,enablePagination:!0,suppressPaginationOnFocus:!0,enableContentCache:!0,enableFinishButton:!0,preloadContent:!1,showFinishButtonAlways:!1,forceMoveForward:!1,saveState:!1,startIndex:0,transitionEffect:e.fn.steps.transitionEffect.none,transitionEffectSpeed:200,onStepChanging:function(){return!0},onStepChanged:function(){},onFinishing:function(){return!0},onFinished:function(){},labels:{current:"current step:",finish:"Finish",next:"Next",previous:"Previous",loading:"Loading ..."}},e.fn.steps.getCurrentIndex=function(){return e(this).data("state").currentIndex},e.fn.steps.getCurrentStep=function(){return e(this).data("state").currentStep},e.fn.steps.getStep=function(t){var n=e(this),a=n.data("state");return t===a.currentStep?a.currentStep:p(n,t)},e.fn.steps.next=function(){var t=e(this);return n(t,t.data("state").currentIndex+1)},e.fn.steps.previous=function(){var t=e(this);return n(t,t.data("state").currentIndex-1)},e.fn.steps.skip=function(){throw Error("Not yet implemented!")},e.fn.steps.finish=function(){var t=e(this),n=(t.data("options"),t.data("state")),a=e(".steps li:eq("+n.currentIndex+")",t);t.triggerHandler("finishing",[n.currentIndex])?(a.addClass("done").removeClass("error"),t.triggerHandler("finished",[n.currentIndex])):a.eq(n.currentIndex).addClass("error")},e.fn.steps.remove=function(t){var n=e(this),a=(n.data("options"),n.data("state"));if(0>t||t>a.stepCount||a.currentIndex===t)return!1;var s=n.children(".content");return e(".title:eq("+t+")",s).remove(),e(".body:eq("+t+")",s).remove(),e(".steps > ol > li:eq("+t+")",n).remove(),a.currentIndex>t&&(a.currentIndex--,b(n,a.currentIndex)),a.stepCount--,a.currentStep=p(n,a.currentIndex),0===t&&e(".steps > ol > li:first",n).addClass("first"),t===a.stepCount&&e(".steps > ol > li:eq("+t+")",n).addClass("last"),o(n,t),l(n),!0},e.fn.steps.add=function(t){var n=e(this);return n.steps("insert",n.data("state").stepCount,t),n},e.fn.steps.insert=function(t,n){var a=e(this),s=a.data("options"),i=a.data("state");if(0>t||t>i.stepCount)throw Error("Index out of range.");var d=a.children(".content"),c=e(document.createElement(s.headerTag)).html(n.title),u=e(document.createElement(s.bodyTag)).addClass("body").hide();return(null==n.contentMode||n.contentMode===e.fn.steps.contentMode.html)&&u.html(n.content),0===t?d.prepend(u).prepend(c):e(".body:eq("+(t-1)+")",d).after(u).after(c),i.currentIndex>=t&&(i.currentIndex++,b(a,i.currentIndex)),i.stepCount++,r(a,c,t),i.currentStep=p(a,i.currentIndex),e(".steps > ol > li:eq("+t+") > a",a).bind("click.steps",I),o(a,t),l(a),a}})(jQuery);