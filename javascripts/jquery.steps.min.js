/*! 
 * jQuery-steps v0.9.4 - 05/19/2013
 * Copyright (c) 2013 Rafael J. Staib (https://github.com/rstaib/jquery-steps)
 * Licensed under MIT http://www.opensource.org/licenses/MIT
 */
(function(e){function t(t){var n=e.extend(!0,{},e.fn.steps.defaults,t);return this.each(function(){var t=e(this);t.data("options",n),t.data("state",{currentIndex:n.startIndex,currentStep:null,stepCount:0,transitionShowElement:null}),h(t),r(t),n.autoFocus&&1===b&&e(".steps li.current a",t).focus(),t.bind("finishing.steps",n.onFinishing),t.bind("finished.steps",n.onFinished),t.bind("stepChanging.steps",n.onStepChanging),t.bind("stepChanged.steps",n.onStepChanged),n.enableKeyNavigation&&t.keyup(v),e(".steps a",t).bind("click.steps",g),e(".actions a",t).bind("click.steps",C)})}function n(t,n){var a=t.data("options"),r=t.data("state"),s=r.currentIndex;if(n>=0&&r.stepCount>n&&!(a.forceMoveForward&&r.currentIndex>n)){var i=e(".steps a[href$='-"+n+"']",t),o=i.parent().hasClass("disabled");return i.parent().removeClass("disabled"),i.click(),s===r.currentIndex&&o?(i.parent().addClass("disabled"),!1):!0}return!1}function a(t,n){var a=t.data("options"),r=t.data("state");if(0>n||n>=r.stepCount||0===r.stepCount)throw Error("Index out of range.");if(!(a.forceMoveForward&&r.currentIndex>n)){var s=r.currentIndex;if(t.triggerHandler("stepChanging",[r.currentIndex,n])){null!=r.asyncRequest&&r.asyncRequest.abort(),r.currentIndex=n,r.currentStep=u(t,n);var o=e(".steps li",t),l=e("a > .current-info",o.eq(s));o.eq(s).addClass("done").removeClass("current error"),o.eq(n).addClass("current").removeClass("disabled done").children("a").prepend(l).focus(),d(t),i(t);var c=e(".content > .body",t);switch(p(e.fn.steps.transitionEffect,a.transitionEffect)){case e.fn.steps.transitionEffect.fade:r.transitionShowElement=c.eq(n),c.eq(s).fadeOut(a.transitionEffectSpeed,function(){var t=e(this).parents(".wizard"),n=t.data("state");n.transitionShowElement&&(n.transitionShowElement.fadeIn(a.transitionEffectSpeed),n.transitionShowElement=null)}).promise();break;case e.fn.steps.transitionEffect.slide:r.transitionShowElement=c.eq(n),c.eq(s).slideUp(a.transitionEffectSpeed,function(){var t=e(this).parents(".wizard"),n=t.data("state");n.transitionShowElement&&(n.transitionShowElement.slideDown(a.transitionEffectSpeed),n.transitionShowElement=null)}).promise();break;case e.fn.steps.transitionEffect.slideLeft:var f=c.eq(n),h=c.eq(s),m=h.outerWidth(!0),v=n>s?-m:m,C=n>s?m:-m;h.animate({left:v},a.transitionEffectSpeed,function(){e(this).hide()}).promise(),f.css("left",C+"px").show(),f.animate({left:0},a.transitionEffectSpeed).promise();break;default:c.eq(s).hide(),c.eq(n).show()}t.triggerHandler("stepChanged",[n,s])}else e(".steps li:eq("+s+")",t).addClass("error");return!0}}function r(t){var n=t.data("options"),a=t.data("state"),r=e(document.createElement(n.contentContainerTag)).addClass("content");r.html(t.html()),t.addClass("wizard").empty().append(r);var o=r.children(n.headerTag),l=r.children(n.bodyTag).addClass("body");if(l.not(":eq("+n.startIndex+")").hide(),l.eq(n.startIndex).show(),o.length>l.length)throw Error("One or more corresponding step contents are missing.");if(o.length<l.length)throw Error("One or more corresponding step titles are missing.");var c=e(document.createElement(n.stepsContainerTag)).addClass("steps").append(e(document.createElement("ol")));if(t.prepend(c),o.each(function(n){s(t,e(this),n)}),a.stepCount=l.length,a.currentStep=u(t,a.currentIndex),n.enablePagination){var p=e(document.createElement("ul")),f=e(document.createElement(n.actionContainerTag)).addClass("actions").append(p);t.append(f),n.forceMoveForward||p.append(e('<li><a href="#previous">'+n.labels.previous+"</a></li>")),p.append(e('<li><a href="#next">'+n.labels.next+"</a></li>")),n.enableFinishButton&&p.append(e('<li><a href="#finish">'+n.labels.finish+"</a></li>")),d(t),i(t)}}function s(t,n,a){var r=t.data("options");n.attr("id",m(t)+"-"+a).attr("tabindex","-1").addClass("title");var s=l(r.titleTemplate,{index:a+1,title:n.html()}),i=e("<li></li>").html('<a href="#'+n.attr("id")+'">'+s+"</a>");0===a&&i.addClass("first"),a===r.startIndex&&i.addClass("current").children("a").prepend('<span class="current-info">'+r.labels.current+" </span>"),r.startIndex>a&&i.addClass("done"),a>r.startIndex&&!r.enableAllSteps&&i.addClass("disabled");var o=e(".steps > ol",t);0===a?o.prepend(i):e("li:eq("+(a-1)+")",o).after(i)}function i(t){var n=t.data("options"),a=t.data("state");if(!n.enableContentCache||!a.currentStep.contentLoaded)switch(p(e.fn.steps.contentMode,a.currentStep.contentMode)){case e.fn.steps.contentMode.iframe:e(".content > .body",t).eq(a.currentIndex).empty().html(e('<iframe src="'+a.currentStep.contentUrl+'" />')).data("loaded","1");break;case e.fn.steps.contentMode.async:var r=e(".content > .body",t).eq(a.currentIndex).empty().append(l(n.loadingTemplate,{text:n.labels.loading}));e.ajax({url:a.currentStep.contentUrl,cache:!1}).done(function(e){r.empty().html(e).data("loaded","1")})}}function o(t,n){for(var a=t.data("options"),r=n;t.data("state").stepCount>r;r++){var s=e(".content > .title:eq("+r+")",t).attr("id",m(t)+"-"+r);e(".steps > ol > li:eq("+r+") > a",t).attr("href","#"+m(t)+"-"+r).html(l(a.titleTemplate,{index:r+1,title:s.html()}))}}function d(t){var n=t.data("options"),a=t.data("state");if(n.enablePagination){var r=e(".actions a[href$='#finish']",t).parent(),s=e(".actions a[href$='#next']",t).parent();if(!n.forceMoveForward){var i=e(".actions a[href$='#previous']",t).parent();a.currentIndex>0?i.removeClass("disabled"):i.addClass("disabled")}n.enableFinishButton&&n.showFinishButtonAlways?0===a.stepCount?(r.addClass("disabled"),s.addClass("disabled")):a.stepCount>1&&a.stepCount>a.currentIndex+1?(r.removeClass("disabled"),s.removeClass("disabled")):(r.removeClass("disabled"),s.addClass("disabled")):0===a.stepCount?(r.hide(),s.show().addClass("disabled")):a.stepCount>1&&a.stepCount>a.currentIndex+1?(r.hide(),s.show().removeClass("disabled")):n.enableFinishButton?(r.show(),s.hide().removeClass("disabled")):s.addClass("disabled")}}function l(e,t){for(var n=e.match(/#([a-z]*)#/gi),a=0;n.length>a;a++){var r=n[a],s=r.substring(1,r.length-1);e=e.replace(r,c(t,s))}return e}function c(e,t){if(void 0===e[t])throw Error('The key "'+t+'" does not exist in the substitute collection!');return e[t]}function u(t,n){var a=(t.data("options"),e(".content > .title:eq("+n+")",t)),r=a.next(".body"),s=null==r.data("mode")?e.fn.steps.contentMode.html:p(e.fn.steps.contentMode,/^\s*$/.test(r.data("mode"))||isNaN(r.data("mode"))?r.data("mode"):Number(r.data("mode"))),i=s===e.fn.steps.contentMode.html||void 0===r.data("url")?"":r.data("url"),o=s!==e.fn.steps.contentMode.html&&"1"===r.data("loaded");return{title:a.html(),content:s===e.fn.steps.contentMode.html?r.html():"",contentUrl:i,contentMode:s,contentLoaded:o}}function p(e,t){if(f("enumType",e),f("keyOrValue",t),"string"==typeof t){var n=e[t];if(void 0===n)throw Error('The enum key "'+t+'" does not exist.');return n}if("number"==typeof t){for(var a in e)if(e[a]===t)return t;throw Error('Invalid enum value "'+t+'".')}throw Error("Invalid key or value type.")}function f(e,t){if(null==t)throw Error('The argument "'+e+'" is null or undefined.')}function h(e){void 0===e.data("uid")&&e.data("uid","steps-uid-".concat(++b))}function m(e){return e.data("uid")}function v(t){var n=e(this);if(n.data("options").suppressPaginationOnFocus&&e(":focus",n).is(":input"))return t.preventDefault(),!1;var a={left:37,right:39};t.keyCode===a.left?(t.preventDefault(),n.steps("previous")):t.keyCode===a.right&&(t.preventDefault(),n.steps("next"))}function C(t){t.preventDefault();var n=e(this),a=n.parents(".wizard");switch(n.attr("href").substring(n.attr("href").lastIndexOf("#"))){case"#finish":a.steps("finish");break;case"#next":a.steps("next");break;case"#previous":a.steps("previous")}}function g(t){t.preventDefault();var n=e(this),r=n.parents(".wizard"),s=r.data("state"),i=s.currentIndex;return n.parent().is(":not(.disabled):not(.current)")&&a(r,Number(n.attr("href").substring(n.attr("href").lastIndexOf("-")+1))),i===s.currentIndex?(e(".steps a[href$=-"+i+"]",r).focus(),!1):void 0}var b=0;e.fn.steps=function(n){return e.fn.steps[n]?e.fn.steps[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?(e.error("Method "+n+" does not exist on jQuery.steps"),void 0):t.apply(this,arguments)},e.fn.steps.contentMode={html:0,iframe:1,async:2},e.fn.steps.transitionEffect={none:0,fade:1,slide:2,slideLeft:3},e.fn.steps.defaults={headerTag:"h1",bodyTag:"div",contentContainerTag:"div",actionContainerTag:"div",stepsContainerTag:"div",titleTemplate:'<span class="number">#index#.</span> #title#',loadingTemplate:'<span class="spinner"></span> #text#',autoFocus:!1,enableAllSteps:!1,enableKeyNavigation:!0,enablePagination:!0,suppressPaginationOnFocus:!0,enableContentCache:!0,enableFinishButton:!0,preloadContent:!1,showFinishButtonAlways:!1,forceMoveForward:!1,startIndex:0,transitionEffect:e.fn.steps.transitionEffect.none,transitionEffectSpeed:200,onStepChanging:function(){return!0},onStepChanged:function(){},onFinishing:function(){return!0},onFinished:function(){},labels:{current:"current step:",finish:"Finish",next:"Next",previous:"Previous",loading:"Loading ..."}},e.fn.steps.getCurrentIndex=function(){return e(this).data("state").currentIndex},e.fn.steps.getCurrentStep=function(){return e(this).data("state").currentStep},e.fn.steps.getStep=function(t){var n=e(this),a=n.data("state");return t===a.currentStep?a.currentStep:u(n,t)},e.fn.steps.next=function(){var t=e(this);return n(t,t.data("state").currentIndex+1)},e.fn.steps.previous=function(){var t=e(this);return n(t,t.data("state").currentIndex-1)},e.fn.steps.skip=function(){throw Error("Not yet implemented!")},e.fn.steps.finish=function(){var t=e(this),n=(t.data("options"),t.data("state")),a=e(".steps li:eq("+n.currentIndex+")",t);t.triggerHandler("finishing",[n.currentIndex])?(a.addClass("done").removeClass("error"),t.triggerHandler("finished",[n.currentIndex])):a.eq(n.currentIndex).addClass("error")},e.fn.steps.remove=function(t){var n=e(this),a=(n.data("options"),n.data("state"));if(0>t||t>a.stepCount||a.currentIndex===t)return!1;var r=n.children(".content");return e(".title:eq("+t+")",r).remove(),e(".body:eq("+t+")",r).remove(),e(".steps > ol > li:eq("+t+")",n).remove(),0===t&&e(".title:first",r).addClass("first"),a.currentIndex>=t&&(a.currentIndex=a.currentIndex+1),a.stepCount=e(".body",r).length,a.currentStep=u(n,a.currentIndex),o(n,t),d(n),!0},e.fn.steps.add=function(t){var n=e(this);return n.steps("insert",n.data("state").stepCount,t),n},e.fn.steps.insert=function(t,n){var a=e(this),r=a.data("options"),i=a.data("state");if(0>t||t>i.stepCount)throw Error("Index out of range.");var l=a.children(".content"),c=e(document.createElement(r.headerTag)),p=e(document.createElement(r.bodyTag));return 0===t?l.prepend(p).prepend(c):e(".body:eq("+(t-1)+")",l).after(p).after(c),c.html(n.title),s(a,c,t),e(".steps > ol > li:eq("+t+") > a",a).bind("click.steps",g),0===t&&e(".steps > ol > li",a).removeClass("first").eq(t).addClass("first"),p.addClass("body").hide(),(null==n.contentMode||n.contentMode===e.fn.steps.contentMode.html)&&p.html(n.content),i.currentIndex>=t&&(i.currentIndex=i.currentIndex+1),i.stepCount=l.children(".body").length,i.currentStep=u(a,i.currentIndex),o(a,t),d(a),a}})(jQuery);